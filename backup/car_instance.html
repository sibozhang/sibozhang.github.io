<!DOCTYPE html>
<!--[if lt IE 9]><html class="ie"><![endif]-->
<html lang="en">

<head>
    <link rel="import" href="/common/meta.html?__inline">
    <link rel="import" href="/common/css.html?__inline">
    <link rel="import" href="/common/js.html?__inline">

    <link rel="stylesheet" type="text/css" media="screen and (min-width: 750px)" href="/css/scene/github.css">
    <link rel="stylesheet" type="text/css" media="screen and (min-width: 750px)" href="/css/scene/scene.css">
    <style type="text/css">
    .scene-body .content .github_table {
        border: unset;
        height: unset;
    }
    .markdown-body p,
    .markdown-body blockquote,
    .markdown-body ul,
    .markdown-body ol,
    .markdown-body dl,
    .markdown-body table,
    .markdown-body pre {
        font-size: 14px;
        color: #666;
    }
    .markdown-body .title-1 {
        font-size: 20px;
        color: #333;
    }
    .markdown-body .mt60 {
        margin-top: 60px !important;
    }
    .scene-body .content {
        padding-left: 25px;
    }
    .tip-top {
        word-wrap: normal;
    }
    </style>
</head>

<body>
    <link rel="import" href="/common/header.html?__inline">

    <section class="banner main-wrapper scene-banner" id="banner-container">
    </section>
    <section class="main-wrapper">
        <div class="main scene-body" id="scene-container">
            <div class="menu fl"></div>
            <div class="content fl">
                <p class="title-1 mt60" id="to_data_href">1 · Introduction</p>
                <p class="word-1 mt20" id="to_collection_href">For self-driving cars, it is important to detect the other vehicles, pedestrians, riders,
                    etc. The system must understand the 3D relationship of each object in each image frame, especially those surrounding
                    or near the self-driving vehicle.</p>
                <p class="word-1 mt20" id="to_collection_href">This repository contains the evaluation scripts for the 3d car instance understanding challenge of the ApolloScapes dataset.
                    This large-scale dataset contains a diverse set of stereo video sequences recorded in street scenes from different
                    cities, with high quality annotations of 5000+ frames.</p>
                <div class="cb"></div>
                <p class="title-1 mt60" id="to_example_href">2 · Data Example</p>
                <div class="fl mt20 demo">
                    <img src="./public/img/scene/datasets-car-instance.png" width="900px">
                </div>
                <div class="cb"></div>
                <p class="title-1 mt60" id="to_dataset_href">3 · Dataset Download</p>
                <p class="title-2 mt40">Sample data</p>
                <div class="down_list mt20 clearfix">
                    <a class="down_btn fl mr10" href="https://ad-apolloscape.cdn.bcebos.com/3d_car_instance_sample.tar.gz">3d_car_instance_sample.tar.gz</a>
                </div>
                <p class="title-2 mt40">Training data</p>
                <div class="down_list mt20 clearfix">
                    <a class="down_btn fl mr10" value="3d-car-understanding-train">3d-car-understanding-train.tar.gz</a>
                    <!-- <a class="down_btn fl mr10" href="https://ad-apolloscape.cdn.bcebos.com/3d-car-understanding-train.tar.gz">3d-car-understanding-train.tar.gz</a> -->
                </div>
                <p class="title-2 mt40">Testing data</p>
                <div class="down_list mt20 clearfix">
                    <a class="down_btn fl mr10" value="3d-car-understanding-test">3d-car-understanding-test.tar.gz</a>
                    <!-- <a class="down_btn fl mr10" href="https://ad-apolloscape.cdn.bcebos.com/3d-car-understanding-test.tar.gz">3d-car-understanding-test.tar.gz</a> -->
                </div>
                <div class="cb"></div>
                <article class="markdown-body entry-content" itemprop="text">
                    <p class="title-1 mt60" id="to_structure_href">4 · Dataset Structure</p>
                    <p>You may download the dataset from
                        <a href="http://apolloscape.auto/ECCV/challenge.html" rel="nofollow">apollo 3d car challenges</a>
                    </p>
                    <p>The folder structure of the 3d car detection challenge is as follows:</p>
                    <pre><code>{root}/{folder}/{image_name}{ext}
                </code></pre>
                    <p>The meaning of the individual elements is:</p>
                    <ul>
                        <li>
                            <code>camera</code> camera intrinsic parameters.</li>
                        <li>
                            <code>car_models</code> the set of car models, re-saved to python friendly pkl.</li>
                        <li>
                            <code>car_poses</code> labelled car pose in the image.</li>
                        <li>
                            <code>images</code> image set.</li>
                        <li>
                            <code>split</code> training and validation image list.</li>
                    </ul>
                    <p class="title-1 mt60" id="to_scripts_href">5 · Scripts</p>
                    <p>There are several scripts included with the dataset in a folder named
                        <code>scripts</code>
                    </p>
                    <ul>
                        <li>
                            <p>
                                <code>demo.ipynb</code> Demo function for visualization of an labelled image</p>
                        </li>
                        <li>
                            <p>
                                <code>car_models.py</code> central file defining the IDs of all semantic classes and providing mapping between various class properties.</p>
                        </li>
                        <li>
                            <p>
                                <code>render_car_instances.py</code> script for loading image and render image file</p>
                        </li>
                        <li>
                            <p>'renderer/' containing scripts of python wrapper for opengl render a car model from a 3d car mesh. We borrow
                                portion of opengl rendering from
                                <a href="http://www.cvlibs.net/projects/displets/" rel="nofollow">Displets</a> and change to egl offscreen render context and python api.</p>
                        </li>
                        <li>
                            <p>
                                <code>install.sh</code> installation script of this library. Only tested for Ubuntu.</p>
                        </li>
                    </ul>
                    <p>The scripts can be installed by running install.sh in the bash:
                        <code>sudo bash install.sh</code>
                    </p>
                    <p>Please download the sample data from
                        <a href="http://apolloscape.auto/ECCV/challenge.html" rel="nofollow">apollo 3d car challenges</a> with sample data button, and put it under
                        <code>../apolloscape/</code>
                    </p>
                    <p>Then run the following code to show a rendered results:</p>
                    <div class="highlight highlight-source-shell">
                        <pre>python render_car_instances.py --image_name=<span class="pl-s"><span class="pl-pds">'</span>./test_example/pose_res<span class="pl-pds">'</span></span> --data_dir=<span class="pl-s"><span class="pl-pds">'</span>../apolloscape/3d_car_instance_sample<span class="pl-pds">'</span></span></pre>
                    </div>
                    <p class="title-1 mt60" id="to_evaluation_href">6 · Evaluation</p>
                    <p>We follow similar instance mean AP evalution with the
                        <a href="https://github.com/cocodataset/cocoapi">coco dataset evaluation</a>, while consider thresholds using 3D car simlarity metrics (distance, orientation, shape),
                        for distance and orientation, we use similar metrics of evaluating self-localization, i.e. the Euclidean distance
                        for translation and arccos distance with quaternions representation.</p>
                    <p>For shape similarity, we consider the reprojection mask similarity by projecting the 3D model to 10 angles and compute
                        the IoU between each pair of models. The similarity we have is
                        <code>sim_mat.txt</code>
                    </p>
                    <p>For submitting the results, we require paticipants to also contain a estimated car_id which is defined under
                        <code>car_models.py</code> and also the 6DoF estimated car pose relative to camera. As demonstrated in the
                        <code>test_eval_data</code> folder.</p>
                    <p>If you want to have your results evaluated w.r.t car size, please also include an 'area' field for the submitted results
                        by rendering the car on image. Our final results will based on AP over all the cars same as the coco dataset.</p>
                    <p>You may run the following code to have a evaluation sample.</p>
                    <div class="highlight highlight-source-shell">
                        <pre>python eval_car_instances.py --test_dir=<span class="pl-s"><span class="pl-pds">'</span>./test_eval_data/det3d_res<span class="pl-pds">'</span></span> --gt_dir=<span class="pl-s"><span class="pl-pds">'</span>./test_eval_data/det3d_gt<span class="pl-pds">'</span></span> --res_file=<span class="pl-s"><span class="pl-pds">'</span>./test_eval_data/res.txt<span class="pl-pds">'</span></span></pre>
                    </div>
                    <p class="title-1 mt60" id="to_metric_href">7 · Metric formula</p>
                    <p>We adopt the popularly used mean Avergae Precision for object instance evaluation in 3D similar to
                        <a href="http://cocodataset.org/#detection-eval"
                            rel="nofollow">coco detection</a>. However instead of using 2D mask IoU for similarity criteria between predicted instances and
                        ground truth to judge a true positive, we propose to used following 3D metrics containing the perspective of
                        <em>shape</em> (
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/6f9bad7347b91ceebebd3ad7e6f6f2d1.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/6f9bad7347b91ceebebd3ad7e6f6f2d1.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="7.7054801999999905pt" height="14.15524440000002pt/" style="max-width:100%;">
                        </a>),
                        <em>3d translation</em>(
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/4f4f4e395762a3af4575de74c019ebb5.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/4f4f4e395762a3af4575de74c019ebb5.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="5.936097749999991pt" height="20.221802699999984pt/" style="max-width:100%;">
                        </a>) and
                        <em>3d rotation</em>(
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/89f2e0d2d24bcf44db73aab8fc03252c.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/89f2e0d2d24bcf44db73aab8fc03252c.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="7.87295519999999pt" height="14.15524440000002pt/" style="max-width:100%;">
                        </a>) to judge a true positive.</p>
                    <p>Specifically, given an estimated 3d car model in an image
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/36b2583e4d8685215773a8f4cc991656.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/36b2583e4d8685215773a8f4cc991656.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="107.66574884999997pt" height="24.65753399999998pt/" style="max-width:100%;">
                        </a> and ground truth model
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/282ebdd2ff53dca1412d731c08bec6dc.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/282ebdd2ff53dca1412d731c08bec6dc.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="117.63534089999999pt" height="24.65753399999998pt/" style="max-width:100%;">
                        </a>, we evaluate the three estimates repectively as follows:</p>
                    <p>For 3d shape, we consider reprojection similarity, by putting the model at a fix location and rendering 10 views by rotating
                        the object. We compute the mean IoU between the two masks rendered from each view. Formally, the metric is defined
                        as,</p>
                    <p>
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/e3216a2d9236918d9b114a51a53fc95a.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/e3216a2d9236918d9b114a51a53fc95a.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="272.6026000499999pt" height="27.77565449999998pt/" style="max-width:100%;">
                        </a>
                    </p>
                    <p>where
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/a9a3a4a202d80326bda413b5562d5cd1.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/a9a3a4a202d80326bda413b5562d5cd1.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="13.242037049999992pt" height="22.465723500000017pt/" style="max-width:100%;">
                        </a> is a set of camera views.</p>
                    <p>For 3d translation and rotation, we follow the same evaluation metric of self-localization
                        <a href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/self_localization/README.md">README.md</a>.</p>
                    <p>
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/1a16bf6722735f0218334842c3833b50.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/1a16bf6722735f0218334842c3833b50.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="130.72152555pt" height="24.65753399999998pt/" style="max-width:100%;">
                        </a>
                    </p>
                    <p>
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/63afc63bd0e62ce5f7dc09876aba3197.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/63afc63bd0e62ce5f7dc09876aba3197.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="186.14137574999998pt" height="24.65753399999998pt/" style="max-width:100%;">
                        </a>
                    </p>
                    <p>Then, we define a set of 10 thresholds for a true positive prediction from loose criterion to strict criterion:</p>
                    <pre><code>    shapeThrs  - [.5:.05:.95] shape thresholds for $s$
                    rotThrs    - [50:  5:  5] rotation thresholds for $r$
                    transThrs  - [2.8:.3:0.1] trans thresholds for $t$
                </code></pre>
                    <p>where the most loose metric
                        <code>.5, 50, 2.8</code> means shape similarity must
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/82933ae1b048283d7d52c25038a205e8.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/82933ae1b048283d7d52c25038a205e8.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="38.35617554999999pt" height="21.18721440000001pt/" style="max-width:100%;">
                        </a>, rotation distance must
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/9dbc26e62bdd6a9004a4e2eac91577e3.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/9dbc26e62bdd6a9004a4e2eac91577e3.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="42.00916004999999pt" height="21.18721440000001pt/" style="max-width:100%;">
                        </a> and tranlation distance must
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/ca1c10083b32a6b27b4f70128b09b697.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/ca1c10083b32a6b27b4f70128b09b697.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="52.789274999999996pt" height="21.18721440000001pt/" style="max-width:100%;">
                        </a>, and the strict metric can be interprated correspondingly.</p>
                    <p>We use
                        <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/079669763179631abe6c6725d030fb96.svg?invert_in_darkmode&amp;sanitize=true">
                            <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/079669763179631abe6c6725d030fb96.svg?invert_in_darkmode&amp;sanitize=true"
                                align="middle" width="78.25920134999998pt" height="14.15524440000002pt/" style="max-width:100%;">
                        </a> to represent those criteria from loose to strict.</p>
                    <p class="title-1 mt60" id="to_rules_href">8 · Rules of ranking</p>
                    <p>Result benchmark will be:</p>
                    <table class="github_table">
                        <thead>
                            <tr>
                                <th>Method</th>
                                <th align="center">AP</th>
                                <th align="center">AP
                                    <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/f5606b459052f4b8daf6643aa31f3f2a.svg?invert_in_darkmode&amp;sanitize=true">
                                        <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/f5606b459052f4b8daf6643aa31f3f2a.svg?invert_in_darkmode&amp;sanitize=true"
                                            align="middle" width="11.46835139999999pt" height="14.15524440000002pt/" style="max-width:100%;">
                                    </a>
                                </th>
                                <th align="center">AP
                                    <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/a208b77cb1de63a4427210b05991d250.svg?invert_in_darkmode&amp;sanitize=true">
                                        <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/a208b77cb1de63a4427210b05991d250.svg?invert_in_darkmode&amp;sanitize=true"
                                            align="middle" width="11.46835139999999pt" height="14.15524440000002pt/" style="max-width:100%;">
                                    </a>
                                </th>
                                <th align="center">AP
                                    <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/5c71b8d8389a7db46d6f7ca3fe55d85c.svg?invert_in_darkmode&amp;sanitize=true">
                                        <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/5c71b8d8389a7db46d6f7ca3fe55d85c.svg?invert_in_darkmode&amp;sanitize=true"
                                            align="middle" width="33.447178049999984pt" height="14.15524440000002pt/" style="max-width:100%;">
                                    </a>
                                </th>
                                <th align="center">AP
                                    <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/f61e0ba78ad249b2db8b97e556065558.svg?invert_in_darkmode&amp;sanitize=true">
                                        <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/f61e0ba78ad249b2db8b97e556065558.svg?invert_in_darkmode&amp;sanitize=true"
                                            align="middle" width="44.652151499999995pt" height="14.15524440000002pt/" style="max-width:100%;">
                                    </a>
                                </th>
                                <th align="center">AP
                                    <a target="_blank" href="https://github.com/ApolloScapeAuto/dataset-api/blob/master/car_instance/tex/dd49cdc20271fef88b013ce6bb79b762.svg?invert_in_darkmode&amp;sanitize=true">
                                        <img src="https://github.com/ApolloScapeAuto/dataset-api/raw/master/car_instance/tex/dd49cdc20271fef88b013ce6bb79b762.svg?invert_in_darkmode&amp;sanitize=true"
                                            align="middle" width="30.874481549999988pt" height="14.15524440000002pt/" style="max-width:100%;">
                                    </a>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Deepxxx</td>
                                <td align="center">xx</td>
                                <td align="center">xx</td>
                                <td align="center">xx</td>
                                <td align="center">xx</td>
                                <td align="center">xx</td>
                                <td align="center">xx</td>
                            </tr>
                        </tbody>
                    </table>
                    <p>Our ranking will determined by the mean AP as usual.</p>
                    <p class="title-1 mt60" id="to_submission_href">9 · Submission of data format</p>
                    <div class="highlight highlight-source-shell">
                        <pre>├── <span class="pl-c1">test</span>
                │   ├── image1.json
                │   ├── image2.json
                ...</pre>
                    </div>
                    <p>Here
                        <code>image1</code> is string of image name</p>
                    <ul>
                        <li>Example format of image1.json</li>
                    </ul>
                    <div class="highlight highlight-source-shell">
                        <pre>[{
                <span class="pl-s"><span class="pl-pds">"</span>car_id<span class="pl-pds">"</span></span> <span class="pl-c1">:</span> int,
                <span class="pl-s"><span class="pl-pds">"</span>area<span class="pl-pds">"</span></span>: int,
                <span class="pl-s"><span class="pl-pds">"</span>pose<span class="pl-pds">"</span></span> <span class="pl-c1">:</span> [roll,pitch,yaw,x,y,z],
                <span class="pl-s"><span class="pl-pds">"</span>score<span class="pl-pds">"</span></span> <span class="pl-c1">:</span> float,
                }]
                ...</pre>
                    </div>
                    <p>Here
                        <code>roll,pitch,yaw,x,y,z</code> are
                        <code>float32</code> numbers, and car_id is int number, which indicates the type of car. "area" can be computed from the rendering code
                        provided by
                        <code>render_car_instances.py</code> by first rendering an image from the estimated set models and then calculate the area of each instance.</p>
                    <div class="eccv">
                        <a class="task-submission-btn submit_achievement">
                            Participate
                        </a>
                        <a class="task-submission-btn leader_board" href="/leader_board.html" target="_Blank">
                            LeaderBoard
                        </a>
                    </div>
                </article>
<div class="mt60" style="font-size: 18px;text-align: center;">The dataset we released is &nbsp;desensitized street view &nbsp;for academic use only.</div>
            </div>
            <div class="cb"></div>
        </div>
    </section>
    <div class="protocol-bg" id="protocol"></div>
    <div class="protocol_container" id="protocol_container">
    </div>
    <div class="done_load"></div>
    <script type="text/javascript" src="/js/dataset_car_instance.js"></script>

    <link rel="import" href="/common/footer.html?__inline">
</body>

</html>
